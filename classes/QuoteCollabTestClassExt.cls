@isTest
    /**
    * Test  class of code coverage test methods
    * for Quote Collaboration classes
    * CSOpty, RecordAccess, Opty, MyParser
    * Created for Quote Collaboration Q2FY10
    * author - cmiura
    *
    */
    public class QuoteCollabTestClassExt {
        
        @testSetup static void setup(){ 
            ObjectRecordTypeIds__c  testObject = new ObjectRecordTypeIds__c ();
            testObject.AccountChannelRecordTypeId__c = '0123000000004aV';
            testObject.Contact_PDB_RecordTypeId__c='01280000000G6tn';
            testObject.Manual_Lead_RecordTypeId__c='0123000000004aS';
            testObject.eLeadsRecordTypeId__c='0123000000004aR';
            testObject.Opportunity_Global_RecordTypeId__c='01234000000M5rI';
            testObject.Partner_Generated_Lead_RecordTypeId__c='012300000000lFW';
            insert testObject;
            
            Org_Constants__c os =new Org_Constants__c();
            os.Key__c = 'Oppty: ProfileIds to skip Triggers';
            os.non_prod_value__c = '00e30000000dcbfAAA,00e30000000dfUEAAY,00e30000000eca0AAA,00e30000000qiJjAAI,00e30000000dcbgAAA,00e30000000rrZwAAI';
            os.Prod_LT__c = 'GSTS,Data_Migration,Integration_Echo_Suppression,GSTS_Analyst,ADMIN, PSS';
            os.prod_value__c = '00e30000000dcbfAAA,00e30000000dfUEAAY,00e30000000eca0AAA,00e30000000qiJjAAI,00e30000000dcbgAAA,00e30000000rrZwAAI';
            os.Type__c = 'URL';
            insert os;
            
            
            ProfileID__c profileIds = new ProfileID__c();
            profileIds.Cisco_Renewals__c = '00e34000001CQnp';
            profileIds.Cisco_PSS__c = '00e30000000rrZw';
            insert profileIds; 
            Profile profile = [SELECT Id FROM Profile WHERE Name = 'Cisco_Admin' Limit 1];
            Id profileId = profile.id;
            User thisUser = new User(firstName='Test',LastName ='PA Contact', USERNAME='testcsOpty@cisco.com',email='testpa232@cisco.com.test',ALIAS='testCS',COMMUNITYNICKNAME='testCS',ISACTIVE=True,
                                     TIMEZONESIDKEY='America/Los_Angeles',LnP_T_C_Acepted_Date__c=Date.Today()+5,LnP_TC_Reset_Date__c=Date.Today()-5,LnP_TC_Accepted__c=true,PROFILEID =profileId ,LANGUAGELOCALEKEY ='en_US',THEATRE__C='APJC-APAC',
                                     LOCALESIDKEY ='en_US',EMAILENCODINGKEY='UTF-8',Additional_User_Permissions__c='Enable EndUser ACCTCreation');
            insert thisUser;
            
            Utilities.setIsTestMethod(true);
            Utilities.setValidationSkip(true);  
            System.runAs(thisUser){
                
                Id RecordTypeIdopportunity = Schema.SObjectType.Opportunity.getRecordTypeInfosByName().get('Global Deal/Opportunity').getRecordTypeId();
                Account acc= new Account(name='CSOpty Test Account',BillingCity='San Francisco'); 
                insert acc;
                
                Opportunity opty = new Opportunity(Theater__c = 'Americas-Canada',Name='CSOptyTest', AccountId = acc.id, CloseDate=System.today() + 50, Expected_Product__c=10.0,
                                                   error_description__c='error', DealID__c='1', Opportunity_Status__c='Active', recordtypeId=RecordTypeIdopportunity, Opportunity_Owner_AM__c =thisUser.id,
                                                   Competitors__c = 'Abacus', StageName ='1 - Prospect',Start_Date__c=System.today(),End_Date__c=System.today()+1,
                                                   Is_Product_Quote_Integrated__c = 'Yes', Is_Service_Quote_Integrated__c = 'No', CCW_BOM_Integrated_Quote_Id__c = '1001',Position__c='Americas lrpearso',
                                                   CurrencyIsoCode = 'USD',Reason_Code__c='Do Not Renew'); 
                insert opty;
                Opportunity opty1 = new Opportunity(Theater__c = 'Americas-Canada',Name='CSOptyTest1', AccountId = acc.id, CloseDate=System.today() + 50, Expected_Product__c=10.0,
                                                    error_description__c='error', DealID__c='1', Opportunity_Status__c='Active', recordtypeId=RecordTypeIdopportunity, Opportunity_Owner_AM__c =thisUser.id,
                                                    Competitors__c = 'Abacus', StageName ='1 - Prospect',Start_Date__c=System.today(),End_Date__c=System.today()+1,
                                                    Is_Product_Quote_Integrated__c = 'Yes', Is_Service_Quote_Integrated__c = 'No', CCW_BOM_Integrated_Quote_Id__c = '1001',Position__c='Americas lrpearso',
                                                    CurrencyIsoCode = 'USD',Reason_Code__c='Do Not Renew'); 
                insert opty1;
                
                Quote__c quote = new Quote__c( Name = 'CSOpty Quote',
                                              Opportunity_Name__c  =  opty.Id ,
                                              DM_Quote_ID__c = '1001',
                                              Quote_Product_List_Amount__c= 185.0,
                                              Quote_Product_Net_Amount__c = 107.0,
                                              Quote_Service_List_Amount__c = 0.0,
                                              Quote_Service_Net_Amount__c = 0.0,
                                              CBN_Status__c = 'NOT ELIGIBLE' , 
                                              CurrencyIsoCode = 'USD',
                                              CCW_Deal_Status_MQ__c = 'Not Approved' ,
                                              Integrate_Status__c='Inprogress'
                                             );
                insert quote; 
                
                Partner_Contact__c pc= new Partner_Contact__c(name='pcname',Partner_Name__c=acc.id);
                insert pc;
                Partner_Contact_Oppty_Mapping__c pcom= new Partner_Contact_Oppty_Mapping__c(Partner_Contact__c=pc.id,Opportunity__c=opty.id);
                insert pcom;
            }
            
        }
        public static testMethod Lead testLeadId(){
            //insert account
            Account endCustomerAccount;
            endCustomerAccount = new Account(name='Test End-User Account',CRName__c ='Test End-User Account',RECORDTYPEID='0123000000004aUAAQ',Country__c='UNITED STATES');
            insert endCustomerAccount;
            Lead newLead = new Lead(
                LastName = 'CSOptytacTest1_B',
                Company='tacTest1 account',
                Email='email1@email.com',
                Main_Technology__c='OTHER',
                Status='1 Waiting',
                Address_Line_1__c='address 1',
                CustomCity__c = 'city 1',
                CustomCountry__c = 'United States',
                End_Customer_Account__c = endCustomerAccount.Id,
                LeadSource = System.label.Lead_TAC_Generated_Source,
                Source_System_Id__c = 'tac1-2',
                isconverted = false,
                Expected_Service_List_Amount__c =12,
                Expected_Product_List_Amount__c = 13,
                Quote_Product_Net_Price__c = 14,
                Quote_Service_Net_Price__c = 11,
                Lead_Qualified_Date__c = DateTime.now());
            
            insert newLead;
            //@@ 10/05 Added CreatedDate filter
            Lead LeadIDOne=[SELECT Id FROM Lead where isconverted = false AND CreatedDate > LAST_N_QUARTERS:2 limit 1 ];
            
            Lead testLeadId=LeadIDOne.clone(true);
            return testLeadId;
            
        }
        static testMethod void testaddPartner(){
            Opportunity opptyVal = [Select id ,DealID__c, Name from Opportunity where Name ='CSOptyTest' limit 1];
            Account acctest = [Select id ,Name from Account where name ='CSOpty Test Account' limit 1];
            List<Partner_Contact_Oppty_Mapping__c> testList  = new List<Partner_Contact_Oppty_Mapping__c>();
            String opptyId = String.valueOf(opptyVal.id);
            Partner_Contact_Oppty_Mapping__c pcom= [Select id,Opportunity__c from Partner_Contact_Oppty_Mapping__c  where Opportunity__c = :opptyId limit 1 ];
            testList.add(pcom);
            test.startTest();                        
            CSOpty.addChangePartner(opptyVal.DealID__c,'','','');
            String result = CSOpty.addChangePartner(opptyVal.DealID__c,'',acctest.id,'');
            System.assertEquals('SUCCESS', result);
            test.stopTest(); 
        }
        
        static testMethod void testChangePartner(){
            Opportunity opptyVal = [Select id ,DealID__c, Name from Opportunity where Name ='CSOptyTest' limit 1];
            Account acc1 = GenericStaticTestData.gettestChannelAccountRecord1();
            Account acctest = [Select id ,Name from Account where name ='CSOpty Test Account' limit 1]; 
            string accountXML ='<AccountList><Account><Type>Host</Type><Id>00130000003sEdSAAU</Id><HQSiteID__c>true</HQSiteID__c><AddressLine1__c>VIA TIBURTINA 605</AddressLine1__c><AddressLine2__c>null</AddressLine2__c><CSCID__c>863780</CSCID__c><CSCSiteID__c>9120461</CSCSiteID__c><City__c>ROMA</City__c><Country__c>ITALY</Country__c><Name>SOFTWAY SRL</Name><State__c>RM</State__c><TOKENID__c>null</TOKENID__c><ZipPostalCode__c>00159</ZipPostalCode__c><PGTMV_FLAG>N</PGTMV_FLAG><Partner_ID__c>90819720</Partner_ID__c><Partner360_Flag__c>Y</Partner360_Flag__c><Type>Host</Type></Account><Account><Type>Agent</Type><Id>0018000000Nt66GAAR</Id><HQSiteID__c>false</HQSiteID__c><AddressLine1__c>13595 Dulles Technology Drive</AddressLine1__c><AddressLine2__c>null</AddressLine2__c><CSCID__c>138998</CSCID__c><CSCSiteID__c>36148714</CSCSiteID__c><City__c>Herndon</City__c><Country__c>UNITED STATES</Country__c><Name>ePlus Technology inc</Name><State__c>VA</State__c><TOKENID__c>null</TOKENID__c><ZipPostalCode__c>20171</ZipPostalCode__c><Partner_ID__c>9999</Partner_ID__c><PGTMV_FLAG>N</PGTMV_FLAG><Partner360_Flag__c>N</Partner360_Flag__c><Type>Agent</Type></Account></AccountList>'; 
            test.startTest();
            CSOpty.changePartner(opptyVal.id,acc1.id,accountXML);
            opptyVal.Primary_Partner__c=acc1.id;
            opptyVal.Partner_2__c =acc1.id;
            opptyVal.Partner_3__c = acc1.id;
            opptyVal.Partner_4__c =acc1.id;
            opptyVal.Partner_5__c =acc1.id;
            update opptyVal;
            CSOpty.changePartner(opptyVal.id,'',accountXML);
            test.stopTest();  
        }
        static testMethod void testChangePartner1(){
            Opportunity opptyVal = [Select id ,DealID__c, Name from Opportunity where Name ='CSOptyTest' limit 1];
            Account acc1 = GenericStaticTestData.gettestChannelAccountRecord1();
            Account acctest = [Select id ,Name from Account where name ='CSOpty Test Account' limit 1]; 
            string accountXML ='<AccountList><Account><Type>Host</Type><Id>+acc1.Id+</Id><HQSiteID__c>False</HQSiteID__c><AddressLine1__c>VIA TIBURTINA 605</AddressLine1__c><AddressLine2__c>null</AddressLine2__c><CSCID__c>863780</CSCID__c><CSCSiteID__c>9120461</CSCSiteID__c><City__c>ROMA</City__c><Country__c>ITALY</Country__c><Name>SOFTWAY SRL</Name><State__c>RM</State__c><TOKENID__c>null</TOKENID__c><ZipPostalCode__c>00159</ZipPostalCode__c><PGTMV_FLAG>N</PGTMV_FLAG><Partner_ID__c>90819720</Partner_ID__c><Partner360_Flag__c>Y</Partner360_Flag__c><Type>Host</Type></Account><Account><Type>Agent</Type><Id>0018000000Nt66GAAR</Id><HQSiteID__c>false</HQSiteID__c><AddressLine1__c>13595 Dulles Technology Drive</AddressLine1__c><AddressLine2__c>null</AddressLine2__c><CSCID__c>138998</CSCID__c><CSCSiteID__c>36148714</CSCSiteID__c><City__c>Herndon</City__c><Country__c>UNITED STATES</Country__c><Name>ePlus Technology inc</Name><State__c>VA</State__c><TOKENID__c>null</TOKENID__c><ZipPostalCode__c>20171</ZipPostalCode__c><Partner_ID__c>9999</Partner_ID__c><PGTMV_FLAG>N</PGTMV_FLAG><Partner360_Flag__c>N</Partner360_Flag__c><Type>Agent</Type></Account></AccountList>'; 
            test.startTest();
            string ptnrID = 'FALSE';
            CSOpty.changePartner(opptyVal.id,acc1.id,accountXML);
            opptyVal.Primary_Partner__c=acc1.id;
            opptyVal.Partner_2__c =acc1.id;
            opptyVal.Partner_3__c = acc1.id;
            opptyVal.Partner_4__c =acc1.id;
            opptyVal.Partner_5__c =acc1.id;
            update opptyVal;
            CSOpty.changePartner(opptyVal.id,'',accountXML);
            test.stopTest();  
        }
        static testMethod void testCreateQuote(){
            Opportunity opptyVal = [Select id ,DealID__c, Name from Opportunity where Name ='CSOptyTest' limit 1];
            Opportunity opptyVal1=[Select id, DealID__c, Name from Opportunity where Name='CSOptyTest1' limit 1];
            opptyVal.Name='CSOptyTestCSOptyTestCSOptyTestCSOptyTestCSOptyTestCSOptyTestCSOptyTestCSOptyTestCSOptyTestCSOptyTest';
            update opptyVal;
            //Account acctest = [Select id ,Name from Account where name ='CUSTOMER - STICHTING INTEGRAAL KANKERCENTRUM NEDERLAND' limit 1];
            Account acctest =new Account(name='Test End-User Account',CRName__c ='Test End-User Account',RECORDTYPEID='0123000000004aUAAQ',Country__c='UNITED STATES');
            insert acctest; 
            //User thisUser =[Select id ,UserName from User where UserName='autoproc@00d3b0000009pbmuam' limit 1];
            //insert thisUser;
            Profile p = [SELECT Id FROM Profile WHERE Name = 'Cisco_Admin' Limit 1];
            User admUser = new User(Additional_User_Permissions__c = 'Enable EndUser ACCTCreation', Alias = 'newUser', Email = 'batchJobOppty@cisco.com',
                               EmailEncodingKey = 'UTF-8', LastName = 'Testing', LanguageLocaleKey = 'en_US',
                               LocaleSidKey = 'en_US', ProfileId = p.Id, TimeZoneSidKey = 'America/Los_Angeles', UserName = 'batchJobOppty@cisco.com.testing', Theatre__c = 'Americas-US Commercial');
            insert admUser; 
            DateTime testTime = system.now();
            Pricebook2 pb2 = lxTestDataFactory.createPriceBook2();
            insert pb2;
            //Id pricebookId = Test.getStandardPricebookId();
            Product2 pr2 = lxTestDataFactory.createSingleProduct();
            insert pr2;
            PricebookEntry pbe = lxTestDataFactory.createSinglePricebookEntry(pb2.Id,pr2.Id);
            insert pbe;
            OpportunityLineItem oli = lxTestDataFactory.createSingleOpportunityLineItem(pr2.id,opptyVal.id,pbe.id);
            insert oli;
            test.startTest();
            CSOpty.nvl('null');
            CSOpty.doTiming(22,'timing');
            CSOpty.copyLineItems(opptyVal.id,opptyVal1.id);
            pr2.ProductCode ='Service';
            update pr2;
            CSOpty.copyLineItems(opptyVal.id,opptyVal1.id);
            CSOpty.getCurrConvRate(opptyVal.id,'AUD');
            String result = CSOpty.addQuote(acctest.id,opptyVal.id,opptyVal.Name,admUser.id,testTime,acctest.id,'1234','testQuote','new','In progress',2,3,system.today(),'true',3,5,'false');
            system.assertEquals('', result);
            test.stopTest(); 
        }
        
        static testMethod void testModifySOM(){
            Lead testLeadId=QuoteCollabTestClassExt.testLeadId();
            Opportunity opptyVal = [Select id ,DealID__c, Name from Opportunity where Name ='CSOptyTest' limit 1];
            test.startTest();
            Opty o = new Opty();
            o.setDealId(opptyVal.DealID__c);
            o.setName('testCSoptty');
            //o.isStartDateNull='test';
            String outXML = '<ns0:Opportunity xmlns:ns0=\"http://www.cisco.com/cixs2.0/oagis\"><ns0:OpportunityHeader><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID></ns1:ID></ns1:DocumentID><ns0:Discount><ns0:Name>Multiple</ns0:Name></ns0:Discount><ns1:IntendedUseOfOpportunity xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Stadium Vision]]></ns1:IntendedUseOfOpportunity><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-11Aug08-01]]></ns1:Note><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-10JAN09-cm8x]]></ns1:Name><ns1:TotalAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">45.0</ns1:TotalAmount><ns1:BudgetedAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">12.0</ns1:BudgetedAmount><ns0:SalesPosition><![CDATA[UK CENTRAL GOVT kamalpat]]></ns0:SalesPosition><ns0:NonStandardTermsCode>None</ns0:NonStandardTermsCode><ns0:NetPriceIndicator>true</ns0:NetPriceIndicator><ns0:Deal><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID>2976889</ns1:ID></ns1:DocumentID><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Test Deal for CAM conversion]]></ns1:Note><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Y</ns1:Code><ns1:EffectiveDateTime>2008-09-01</ns1:EffectiveDateTime></ns1:Status><ns0:DeskStatus><ns1:Code xmlns:ns1=\"http://www.openapplications.org/oagis/9\">Active</ns1:Code></ns0:DeskStatus><ns0:ExpiryDateTime>2008-10-10</ns0:ExpiryDateTime><ns0:ApprovalRoute>5</ns0:ApprovalRoute></ns0:Deal><ns1:CurrencyCode xmlns:ns1=\"http://www.openapplications.org/oagis/9\">USD</ns1:CurrencyCode><ns0:TotalProductAmount currencyID=\"USD\">1</ns0:TotalProductAmount> <ns0:TotalServiceAmount currencyID=\"USD\">2</ns0:TotalServiceAmount> <ns0:WorkforceReference><ns0:UserID>asaric</ns0:UserID></ns0:WorkforceReference><ns0:CustomerParty><ns0:PartyId><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[0013000000GgQtE]]></ns1:ID></ns0:PartyId><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[HOUSES OF PARLIAMENT]]></ns1:Name></ns0:CustomerParty><ns0:SalesLeadReference><ns0:DocumentID><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA['+testLeadId.Id+']]></ns1:ID></ns0:DocumentID></ns0:SalesLeadReference><ns0:WhoWhenData><ns0:UpdatedBy>jchambers</ns0:UpdatedBy><ns0:UpdatedOn>2009-02-10 01:56:37</ns0:UpdatedOn></ns0:WhoWhenData><ns0:SalesLeadReference><ns0:StatusCode>Y</ns0:StatusCode></ns0:SalesLeadReference></ns0:OpportunityHeader><ns0:OpportunityDetail><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Approved</ns1:Code></ns1:Status><ns1:CompetitorParty xmlns:ns1=\"http://www.openapplications.org/oagis/9\"/><ns0:OpportunityTechnology><ns0:Technology><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Cable]]></ns1:Name></ns0:Technology><ns0:TechnologyMixPercentage>100.0</ns0:TechnologyMixPercentage></ns0:OpportunityTechnology><ns0:OpportunityService><ns0:ServiceProgram><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare</ns1:Name><ns1:ServiceLevel xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare Software</ns1:ServiceLevel><ns0:ServiceMixPercentage>100</ns0:ServiceMixPercentage></ns0:ServiceProgram></ns0:OpportunityService><ns0:ExpectedBookingDateTime>2008-08-22</ns0:ExpectedBookingDateTime><ns0:ExpectedProductBookingAmount currencyID=\"USD\">48.0</ns0:ExpectedProductBookingAmount><ns0:ExpectedServiceBookingAmount currencyID=\"USD\">0.0</ns0:ExpectedServiceBookingAmount><ns0:SalesStageCode>1 - Prospect</ns0:SalesStageCode><ns0:Forecast><ns0:Code>Not Forecastable</ns0:Code></ns0:Forecast><ns1:MarketingProgram xmlns:ns1=\"http://www.openapplications.org/oagis/9\"> <ns1:ID>31128</ns1:ID> <ns1:Description><![CDATA[PP-NFRf29874-080426]]></ns1:Description> <ns1:OfferDescription><![CDATA[NFR for Specialised and Certified Partners]]></ns1:OfferDescription> <ns1:OpportunityType><![CDATA[NFR (Not-for-Resale)]]></ns1:OpportunityType> </ns1:MarketingProgram><ns0:CompetitorParty>j<ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Adtran]]></ns1:Name></ns0:CompetitorParty><ns0:WorkforceReference><ns0:UserID><![CDATA[asaric]]></ns0:UserID></ns0:WorkforceReference><ns0:PullForwardDateTime>1973-05-29</ns0:PullForwardDateTime></ns0:OpportunityDetail></ns0:Opportunity>';  
            CSopty.modifySOM(outXML,opptyVal.dealID__c);
            test.stopTest();
        }
        static testMethod void testModify(){
            Lead testLeadId=QuoteCollabTestClassExt.testLeadId();
            Quote__c testQuote = [Select Id,Name from Quote__c where Name ='CSOpty Quote'];
            Opportunity opptyVal = [Select id ,DealID__c, Name from Opportunity where Name ='CSOptyTest' limit 1];
            test.startTest();
            Opty o = new Opty();
            o.setDealId(opptyVal.DealID__c);
            o.setName('testCSoptty');
            o.setQuoteID('1001');
            String outXML = '<ns0:Opportunity xmlns:ns0=\"http://www.cisco.com/cixs2.0/oagis\"><ns0:OpportunityHeader><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID></ns1:ID></ns1:DocumentID><ns0:Discount><ns0:Name>Multiple</ns0:Name></ns0:Discount><ns1:IntendedUseOfOpportunity xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Stadium Vision]]></ns1:IntendedUseOfOpportunity><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-11Aug08-01]]></ns1:Note><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-10JAN09-cm8x]]></ns1:Name><ns1:TotalAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">45.0</ns1:TotalAmount><ns1:BudgetedAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">12.0</ns1:BudgetedAmount><ns0:SalesPosition><![CDATA[UK CENTRAL GOVT kamalpat]]></ns0:SalesPosition><ns0:NonStandardTermsCode>None</ns0:NonStandardTermsCode><ns0:NetPriceIndicator>true</ns0:NetPriceIndicator><ns0:Deal><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID>2976889</ns1:ID></ns1:DocumentID><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Test Deal for CAM conversion]]></ns1:Note><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Y</ns1:Code><ns1:EffectiveDateTime>2008-09-01</ns1:EffectiveDateTime></ns1:Status><ns0:DeskStatus><ns1:Code xmlns:ns1=\"http://www.openapplications.org/oagis/9\">Active</ns1:Code></ns0:DeskStatus><ns0:ExpiryDateTime>2008-10-10</ns0:ExpiryDateTime><ns0:ApprovalRoute>5</ns0:ApprovalRoute></ns0:Deal><ns1:CurrencyCode xmlns:ns1=\"http://www.openapplications.org/oagis/9\">USD</ns1:CurrencyCode><ns0:TotalProductAmount currencyID=\"USD\">1</ns0:TotalProductAmount> <ns0:TotalServiceAmount currencyID=\"USD\">2</ns0:TotalServiceAmount> <ns0:WorkforceReference><ns0:UserID>asaric</ns0:UserID></ns0:WorkforceReference><ns0:CustomerParty><ns0:PartyId><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[0013000000GgQtE]]></ns1:ID></ns0:PartyId><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[HOUSES OF PARLIAMENT]]></ns1:Name></ns0:CustomerParty><ns0:SalesLeadReference><ns0:DocumentID><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA['+testLeadId.Id+']]></ns1:ID></ns0:DocumentID></ns0:SalesLeadReference><ns0:WhoWhenData><ns0:UpdatedBy>jchambers</ns0:UpdatedBy><ns0:UpdatedOn>2009-02-10 01:56:37</ns0:UpdatedOn></ns0:WhoWhenData><ns0:SalesLeadReference><ns0:StatusCode>Y</ns0:StatusCode></ns0:SalesLeadReference></ns0:OpportunityHeader><ns0:OpportunityDetail><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Approved</ns1:Code></ns1:Status><ns1:CompetitorParty xmlns:ns1=\"http://www.openapplications.org/oagis/9\"/><ns0:OpportunityTechnology><ns0:Technology><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Cable]]></ns1:Name></ns0:Technology><ns0:TechnologyMixPercentage>100.0</ns0:TechnologyMixPercentage></ns0:OpportunityTechnology><ns0:OpportunityService><ns0:ServiceProgram><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare</ns1:Name><ns1:ServiceLevel xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare Software</ns1:ServiceLevel><ns0:ServiceMixPercentage>100</ns0:ServiceMixPercentage></ns0:ServiceProgram></ns0:OpportunityService><ns0:ExpectedBookingDateTime>2008-08-22</ns0:ExpectedBookingDateTime><ns0:ExpectedProductBookingAmount currencyID=\"USD\">48.0</ns0:ExpectedProductBookingAmount><ns0:ExpectedServiceBookingAmount currencyID=\"USD\">0.0</ns0:ExpectedServiceBookingAmount><ns0:SalesStageCode>1 - Prospect</ns0:SalesStageCode><ns0:Forecast><ns0:Code>Not Forecastable</ns0:Code></ns0:Forecast><ns1:MarketingProgram xmlns:ns1=\"http://www.openapplications.org/oagis/9\"> <ns1:ID>31128</ns1:ID> <ns1:Description><![CDATA[PP-NFRf29874-080426]]></ns1:Description> <ns1:OfferDescription><![CDATA[NFR for Specialised and Certified Partners]]></ns1:OfferDescription> <ns1:OpportunityType><![CDATA[NFR (Not-for-Resale)]]></ns1:OpportunityType> </ns1:MarketingProgram><ns0:CompetitorParty>j<ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Adtran]]></ns1:Name></ns0:CompetitorParty><ns0:WorkforceReference><ns0:UserID><![CDATA[asaric]]></ns0:UserID></ns0:WorkforceReference><ns0:PullForwardDateTime>1973-05-29</ns0:PullForwardDateTime></ns0:OpportunityDetail></ns0:Opportunity>';  
            CSopty.modify(outXML,opptyVal.dealID__c);
            test.stopTest();
        }
        
        
        static testMethod void testCreate(){
            Lead testLeadId=QuoteCollabTestClassExt.testLeadId();
            Opportunity opptyVal = [Select id ,DealID__c, Name from Opportunity where Name ='CSOptyTest' limit 1];
            test.startTest();
            Opty o = new Opty();
            String outXML = '<ns0:Opportunity xmlns:ns0=\"http://www.cisco.com/cixs2.0/oagis\"><ns0:OpportunityHeader><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID></ns1:ID></ns1:DocumentID><ns0:Discount><ns0:Name>Multiple</ns0:Name></ns0:Discount><ns1:IntendedUseOfOpportunity xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Stadium Vision]]></ns1:IntendedUseOfOpportunity><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-11Aug08-01]]></ns1:Note><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-10JAN09-cm8x]]></ns1:Name><ns1:TotalAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">45.0</ns1:TotalAmount><ns1:BudgetedAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">12.0</ns1:BudgetedAmount><ns0:SalesPosition><![CDATA[UK CENTRAL GOVT kamalpat]]></ns0:SalesPosition><ns0:NonStandardTermsCode>None</ns0:NonStandardTermsCode><ns0:NetPriceIndicator>true</ns0:NetPriceIndicator><ns0:Deal><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID>2976889</ns1:ID></ns1:DocumentID><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Test Deal for CAM conversion]]></ns1:Note><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Y</ns1:Code><ns1:EffectiveDateTime>2008-09-01</ns1:EffectiveDateTime></ns1:Status><ns0:DeskStatus><ns1:Code xmlns:ns1=\"http://www.openapplications.org/oagis/9\">Active</ns1:Code></ns0:DeskStatus><ns0:ExpiryDateTime>2008-10-10</ns0:ExpiryDateTime><ns0:ApprovalRoute>5</ns0:ApprovalRoute></ns0:Deal><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:DealStatus>leadStatus</ns0:DealStatus></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:ExpectedProductListAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">48.0</ns0:ExpectedProductListAmount></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:PromotionName>testPromotion</ns0:PromotionName></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:ProgramName>testProgramName</ns0:ProgramName></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:DealCreatedDate>1973-05-29</ns0:DealCreatedDate></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:DiscountType>Good</ns0:DiscountType></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:ExpectedServiceListAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">78.0</ns0:ExpectedServiceListAmount></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:EligibleForNS>Y</ns0:EligibleForNS></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:DealExpirationDate>1973-05-29</ns0:DealExpirationDate></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:QuoteProductNetPrice xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">48.0</ns0:QuoteProductNetPrice></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:QuoteServiceNetPrice xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">48.0</ns0:QuoteServiceNetPrice></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:DealDeskStatus>Good</ns0:DealDeskStatus></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:OptyName>testOppty</ns0:OptyName></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:QuoteProductListPrice xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">48.0</ns0:QuoteProductListPrice></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:SalesLeadReference><ns0:UserArea><ns0:SFDCLeadDetails><ns0:QuoteServiceListPrice xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">48.0</ns0:QuoteServiceListPrice></ns0:SFDCLeadDetails></ns0:UserArea></ns0:SalesLeadReference><ns0:CustomerParty><ns0:Contracts><ns0:Contract><ns0:ContractHeader><ns0:QuoteReference><ns0:StatusCode>Y</ns0:StatusCode></ns0:QuoteReference></ns0:ContractHeader></ns0:Contract></ns0:Contracts></ns0:CustomerParty><ns0:CustomerParty><ns0:Contracts><ns0:Contract><ns0:ContractHeader><ns0:QuoteReference><ns0:DocumentID><ns0:ID>12344</ns0:ID></ns0:DocumentID></ns0:QuoteReference></ns0:ContractHeader></ns0:Contract></ns0:Contracts></ns0:CustomerParty><ns0:CustomerParty><ns0:Contracts><ns0:Contract><ns0:ContractHeader><ns0:QuoteReference><ns0:UserArea><ns0:SFDCQuoteDetails><ns0:Dummy_Quote>Quote</ns0:Dummy_Quote></ns0:SFDCQuoteDetails></ns0:UserArea></ns0:QuoteReference></ns0:ContractHeader></ns0:Contract></ns0:Contracts></ns0:CustomerParty><ns0:CustomerParty><ns0:Contracts><ns0:Contract><ns0:ContractHeader><ns0:QuoteReference><ns0:UserArea><ns0:SFDCQuoteDetails><ns0:Is_finalized>Y</ns0:Is_finalized></ns0:SFDCQuoteDetails></ns0:UserArea></ns0:QuoteReference></ns0:ContractHeader></ns0:Contract></ns0:Contracts></ns0:CustomerParty><ns0:CustomerParty><ns0:Contracts><ns0:Contract><ns0:ContractHeader><ns0:QuoteReference><ns0:UserArea><ns0:SFDCQuoteDetails><ns0:Quote_Name>testQuoteName</ns0:Quote_Name></ns0:SFDCQuoteDetails></ns0:UserArea></ns0:QuoteReference></ns0:ContractHeader></ns0:Contract></ns0:Contracts></ns0:CustomerParty><ns1:CurrencyCode xmlns:ns1=\"http://www.openapplications.org/oagis/9\">USD</ns1:CurrencyCode><ns0:TotalProductAmount currencyID=\"USD\">1</ns0:TotalProductAmount><ns0:SourceID >PDR</ns0:SourceID><ns0:TotalServiceAmount currencyID=\"USD\">2</ns0:TotalServiceAmount> <ns0:WorkforceReference><ns0:UserID>asaric</ns0:UserID></ns0:WorkforceReference><ns0:CustomerParty><ns0:PartyId><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[0013000000GgQtE]]></ns1:ID></ns0:PartyId><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[HOUSES OF PARLIAMENT]]></ns1:Name></ns0:CustomerParty><ns0:SalesTask><ns0:Status><ns1:Code xmlns:ns1=\"http://www.openapplications.org/oagis/9\">Y</ns1:Code></ns0:Status></ns0:SalesTask><ns0:SalesLeadReference><ns0:DocumentID><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA['+testLeadId.Id+']]></ns1:ID></ns0:DocumentID></ns0:SalesLeadReference><ns0:WhoWhenData><ns0:UpdatedBy>jchambers</ns0:UpdatedBy><ns0:UpdatedOn>2009-02-10 01:56:37</ns0:UpdatedOn></ns0:WhoWhenData><ns0:SalesLeadReference><ns0:StatusCode>N</ns0:StatusCode></ns0:SalesLeadReference><ns0:OpportunityGeography><ns0:Area>testArea</ns0:Area></ns0:OpportunityGeography><ns0:DocumentReference><ns0:Description>Y</ns0:Description></ns0:DocumentReference></ns0:OpportunityHeader><ns0:OpportunityDetail><ns0:PartnerParty><ns0:OrganizationProfile><ns0:SystemsInventory><ns0:SystemsInfo><ns0:Name>testName</ns0:Name></ns0:SystemsInfo></ns0:SystemsInventory></ns0:OrganizationProfile></ns0:PartnerParty><ns0:OpportunityService><ns0:ServiceProgram><ns0:ServiceLevel><ns0:Name>testName</ns0:Name></ns0:ServiceLevel></ns0:ServiceProgram></ns0:OpportunityService><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Approved</ns1:Code></ns1:Status><ns1:CompetitorParty xmlns:ns1=\"http://www.openapplications.org/oagis/9\"/><ns0:OpportunityTechnology><ns0:Technology><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Cable]]></ns1:Name></ns0:Technology><ns0:TechnologyMixPercentage>100.0</ns0:TechnologyMixPercentage></ns0:OpportunityTechnology><ns0:Item><ns0:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Cable]]></ns0:Name></ns0:Item><ns0:OpportunityService><ns0:ServiceProgram><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare</ns1:Name><ns1:ServiceLevel xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare Software</ns1:ServiceLevel><ns0:ServiceMixPercentage>100</ns0:ServiceMixPercentage></ns0:ServiceProgram></ns0:OpportunityService><ns0:ExpectedBookingDateTime>2008-08-22</ns0:ExpectedBookingDateTime><ns0:ExpectedProductBookingAmount currencyID=\"USD\">48.0</ns0:ExpectedProductBookingAmount><ns0:ExpectedServiceBookingAmount currencyID=\"USD\">0.0</ns0:ExpectedServiceBookingAmount><ns0:SalesStageCode>1 - Prospect</ns0:SalesStageCode><ns0:Forecast><ns0:Code>Not Forecastable</ns0:Code></ns0:Forecast><ns1:MarketingProgram xmlns:ns1=\"http://www.openapplications.org/oagis/9\"> <ns1:ID>31128</ns1:ID> <ns1:Description><![CDATA[PP-NFRf29874-080426]]></ns1:Description> <ns1:OfferDescription><![CDATA[NFR for Specialised and Certified Partners]]></ns1:OfferDescription><ns1:OpportunityMethodCode><![CDATA[NFR for Specialised and Certified Partners test]]></ns1:OpportunityMethodCode><ns1:OpportunityType><![CDATA[NFR (Not-for-Resale)]]></ns1:OpportunityType> </ns1:MarketingProgram><ns0:CompetitorParty>j<ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Adtran]]></ns1:Name></ns0:CompetitorParty><ns0:ContractReference><ns1:StatusCode xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Adtran]]>Y</ns1:StatusCode></ns0:ContractReference><ns0:OpportunityService>j<ns1:RenewalReasonCode xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Adtran]]>Y</ns1:RenewalReasonCode></ns0:OpportunityService><ns0:WorkforceReference><ns0:UserID><![CDATA[asaric]]></ns0:UserID><ns0:Name>testName</ns0:Name></ns0:WorkforceReference><ns0:PullForwardDateTime>1973-05-29</ns0:PullForwardDateTime><ns0:ContractReference><ns0:DocumentID><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Cable]]></ns1:ID></ns0:DocumentID></ns0:ContractReference><ns0:ContractReference><ns0:Period><ns1:StartDateTime >12-6-1890</ns1:StartDateTime><ns1:EndDateTime>12-09-2018</ns1:EndDateTime></ns0:Period></ns0:ContractReference></ns0:OpportunityDetail></ns0:Opportunity>';
            String accountXML ='<AccountList><Account><Type>Host</Type><Id>00130000003sEdSAAU</Id><HQSiteID__c>123.0</HQSiteID__c><AddressLine1__c>VIA TIBURTINA 605</AddressLine1__c><AddressLine2__c>null</AddressLine2__c><CSCID__c>863780</CSCID__c><CSCSiteID__c>9120461</CSCSiteID__c><City__c>ROMA</City__c><Country__c>ITALY</Country__c><Name>SOFTWAY SRL</Name><State__c>RM</State__c><TOKENID__c>null</TOKENID__c><ZipPostalCode__c>00159</ZipPostalCode__c><PGTMV_FLAG>N</PGTMV_FLAG><Partner_ID__c>90819720</Partner_ID__c><Partner360_Flag__c>Y</Partner360_Flag__c><Type>Host</Type></Account></AccountList>';        
            CSOpty.create(outXML,accountXML,opptyVal.DealId__c);
            MyParser testParse = new MyParser();
            CSOpty.serviceCheck(opptyVal.Id);
            test.stopTest();
        }
        static testMethod void testCreateAgent(){
            Lead testLeadId=QuoteCollabTestClassExt.testLeadId();
            Opportunity opptyVal = [Select id ,DealID__c, Name from Opportunity where Name ='CSOptyTest' limit 1];
            test.startTest();
            Opty o = new Opty();
            String outXML ='<ns0:Opportunity xmlns:ns0=\"http://www.cisco.com/cixs2.0/oagis\"><ns0:OpportunityHeader><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID></ns1:ID></ns1:DocumentID><ns0:Discount><ns0:Name>Multiple</ns0:Name></ns0:Discount><ns1:IntendedUseOfOpportunity xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Stadium Vision]]></ns1:IntendedUseOfOpportunity><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-11Aug08-01]]></ns1:Note><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-10JAN09-cm8x]]></ns1:Name><ns1:TotalAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">45.0</ns1:TotalAmount><ns1:SourceID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"> PDR</ns1:SourceID><ns1:BudgetedAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">12.0</ns1:BudgetedAmount><ns0:SalesPosition><![CDATA[UK CENTRAL GOVT kamalpat]]></ns0:SalesPosition><ns0:NonStandardTermsCode>None</ns0:NonStandardTermsCode><ns0:NetPriceIndicator>true</ns0:NetPriceIndicator><ns0:Deal><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID>2976889</ns1:ID></ns1:DocumentID><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Test Deal for CAM conversion]]></ns1:Note><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Y</ns1:Code><ns1:EffectiveDateTime>2008-09-01</ns1:EffectiveDateTime></ns1:Status><ns0:DeskStatus><ns1:Code xmlns:ns1=\"http://www.openapplications.org/oagis/9\">Active</ns1:Code></ns0:DeskStatus><ns0:ExpiryDateTime>2008-10-10</ns0:ExpiryDateTime><ns0:ApprovalRoute>5</ns0:ApprovalRoute></ns0:Deal><ns1:CurrencyCode xmlns:ns1=\"http://www.openapplications.org/oagis/9\">USD</ns1:CurrencyCode><ns0:TotalProductAmount currencyID=\"USD\">1</ns0:TotalProductAmount> <ns0:TotalServiceAmount currencyID=\"USD\">2</ns0:TotalServiceAmount> <ns0:WorkforceReference><ns0:UserID>asaric</ns0:UserID></ns0:WorkforceReference><ns0:CustomerParty><ns0:PartyId><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[0013000000GgQtE]]></ns1:ID></ns0:PartyId><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[HOUSES OF PARLIAMENT]]></ns1:Name></ns0:CustomerParty><ns0:SalesLeadReference><ns0:DocumentID><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA['+testLeadId.Id+']]></ns1:ID></ns0:DocumentID></ns0:SalesLeadReference><ns0:WhoWhenData><ns0:UpdatedBy>jchambers</ns0:UpdatedBy><ns0:UpdatedOn>2009-02-10 01:56:37</ns0:UpdatedOn></ns0:WhoWhenData><ns0:SalesLeadReference><ns0:StatusCode>Y</ns0:StatusCode></ns0:SalesLeadReference>><ns0:DocumentReference><ns0:Description>Y</ns0:Description></ns0:DocumentReference></ns0:OpportunityHeader><ns0:OpportunityDetail><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Approved</ns1:Code></ns1:Status><ns1:CompetitorParty xmlns:ns1=\"http://www.openapplications.org/oagis/9\"/><ns0:OpportunityTechnology><ns0:Technology><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Cable]]></ns1:Name></ns0:Technology><ns0:TechnologyMixPercentage>100.0</ns0:TechnologyMixPercentage></ns0:OpportunityTechnology><ns0:OpportunityService><ns0:ServiceProgram><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare</ns1:Name><ns1:ServiceLevel xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare Software</ns1:ServiceLevel><ns0:ServiceMixPercentage>100</ns0:ServiceMixPercentage></ns0:ServiceProgram></ns0:OpportunityService><ns0:ExpectedBookingDateTime>2008-08-22</ns0:ExpectedBookingDateTime><ns0:ExpectedProductBookingAmount currencyID=\"USD\">48.0</ns0:ExpectedProductBookingAmount><ns0:ExpectedServiceBookingAmount currencyID=\"USD\">0.0</ns0:ExpectedServiceBookingAmount><ns0:SalesStageCode>1 - Prospect</ns0:SalesStageCode><ns0:CRP_Flag__c>Y</ns0:CRP_Flag__c><ns0:Forecast><ns0:Code>Not Forecastable</ns0:Code></ns0:Forecast><ns1:MarketingProgram xmlns:ns1=\"http://www.openapplications.org/oagis/9\"> <ns1:ID>31128</ns1:ID> <ns1:Description><![CDATA[PP-NFRf29874-080426]]></ns1:Description> <ns1:OfferDescription><![CDATA[NFR for Specialised and Certified Partners]]></ns1:OfferDescription> <ns1:OpportunityType><![CDATA[NFR (Not-for-Resale)]]></ns1:OpportunityType> </ns1:MarketingProgram><ns0:CompetitorParty>j<ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Adtran]]></ns1:Name></ns0:CompetitorParty><ns0:WorkforceReference><ns0:UserID><![CDATA[asaric]]></ns0:UserID></ns0:WorkforceReference><ns0:PullForwardDateTime>1973-05-29</ns0:PullForwardDateTime></ns0:OpportunityDetail></ns0:Opportunity>'; 
            String accountXML ='<AccountList><Account><Type>Agent</Type><Id>0018000000Nt66GAAR</Id><HQSiteID__c>false</HQSiteID__c><AddressLine1__c>13595 Dulles Technology Drive</AddressLine1__c><AddressLine2__c>null</AddressLine2__c><CSCID__c>138998</CSCID__c><CSCSiteID__c>36148714</CSCSiteID__c><City__c>Herndon</City__c><Country__c>UNITED STATES</Country__c><Name>ePlus Technology inc</Name><State__c>VA</State__c><TOKENID__c>null</TOKENID__c><ZipPostalCode__c>20171</ZipPostalCode__c><Partner_ID__c>9999</Partner_ID__c><PGTMV_FLAG>N</PGTMV_FLAG><Partner360_Flag__c>N</Partner360_Flag__c><Type>Agent</Type></Account>></AccountList>';
            CSOpty.create(outXML,accountXML,opptyVal.DealId__c);
            test.stopTest();
        }
        static testMethod void testdealMerge(){
            Lead testLeadId=QuoteCollabTestClassExt.testLeadId();
            Opportunity opptyVal = [Select id ,DealID__c, Name from Opportunity where Name ='CSOptyTest' limit 1];
            test.startTest();
            Opty o = new Opty();
            o.setP360Flag('Y');
            String outXML = '<ns0:Opportunity xmlns:ns0=\"http://www.cisco.com/cixs2.0/oagis\"><ns0:OpportunityHeader><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID></ns1:ID></ns1:DocumentID><ns0:Discount><ns0:Name>Multiple</ns0:Name></ns0:Discount><ns1:IntendedUseOfOpportunity xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Stadium Vision]]></ns1:IntendedUseOfOpportunity><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-11Aug08-01]]></ns1:Note><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-10JAN09-cm8x]]></ns1:Name><ns1:TotalAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">45.0</ns1:TotalAmount><ns1:BudgetedAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">12.0</ns1:BudgetedAmount><ns0:SalesPosition><![CDATA[UK CENTRAL GOVT kamalpat]]></ns0:SalesPosition><ns0:NonStandardTermsCode>None</ns0:NonStandardTermsCode><ns0:NetPriceIndicator>true</ns0:NetPriceIndicator><ns0:Deal><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID>2976889</ns1:ID></ns1:DocumentID><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Test Deal for CAM conversion]]></ns1:Note><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Y</ns1:Code><ns1:EffectiveDateTime>2008-09-01</ns1:EffectiveDateTime></ns1:Status><ns0:DeskStatus><ns1:Code xmlns:ns1=\"http://www.openapplications.org/oagis/9\">Active</ns1:Code></ns0:DeskStatus><ns0:ExpiryDateTime>2008-10-10</ns0:ExpiryDateTime><ns0:ApprovalRoute>5</ns0:ApprovalRoute></ns0:Deal><ns1:CurrencyCode xmlns:ns1=\"http://www.openapplications.org/oagis/9\">USD</ns1:CurrencyCode><ns0:TotalProductAmount currencyID=\"USD\">1</ns0:TotalProductAmount> <ns0:TotalServiceAmount currencyID=\"USD\">2</ns0:TotalServiceAmount> <ns0:WorkforceReference><ns0:UserID>asaric</ns0:UserID></ns0:WorkforceReference><ns0:CustomerParty><ns0:PartyId><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[0013000000GgQtE]]></ns1:ID></ns0:PartyId><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[HOUSES OF PARLIAMENT]]></ns1:Name></ns0:CustomerParty><ns0:SalesLeadReference><ns0:DocumentID><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA['+testLeadId.Id+']]></ns1:ID></ns0:DocumentID></ns0:SalesLeadReference><ns0:WhoWhenData><ns0:UpdatedBy>jchambers</ns0:UpdatedBy><ns0:UpdatedOn>2009-02-10 01:56:37</ns0:UpdatedOn></ns0:WhoWhenData><ns0:SalesLeadReference><ns0:StatusCode>Y</ns0:StatusCode></ns0:SalesLeadReference></ns0:OpportunityHeader><ns0:OpportunityDetail><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Approved</ns1:Code></ns1:Status><ns1:CompetitorParty xmlns:ns1=\"http://www.openapplications.org/oagis/9\"/><ns0:OpportunityTechnology><ns0:Technology><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Cable]]></ns1:Name></ns0:Technology><ns0:TechnologyMixPercentage>100.0</ns0:TechnologyMixPercentage></ns0:OpportunityTechnology><ns0:OpportunityService><ns0:ServiceProgram><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare</ns1:Name><ns1:ServiceLevel xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare Software</ns1:ServiceLevel><ns0:ServiceMixPercentage>100</ns0:ServiceMixPercentage></ns0:ServiceProgram></ns0:OpportunityService><ns0:ExpectedBookingDateTime>2008-08-22</ns0:ExpectedBookingDateTime><ns0:ExpectedProductBookingAmount currencyID=\"USD\">48.0</ns0:ExpectedProductBookingAmount><ns0:ExpectedServiceBookingAmount currencyID=\"USD\">0.0</ns0:ExpectedServiceBookingAmount><ns0:SalesStageCode>1 - Prospect</ns0:SalesStageCode><ns0:Forecast><ns0:Code>Not Forecastable</ns0:Code></ns0:Forecast><ns1:MarketingProgram xmlns:ns1=\"http://www.openapplications.org/oagis/9\"> <ns1:ID>31128</ns1:ID> <ns1:Description><![CDATA[PP-NFRf29874-080426]]></ns1:Description> <ns1:OfferDescription><![CDATA[NFR for Specialised and Certified Partners]]></ns1:OfferDescription> <ns1:OpportunityType><![CDATA[NFR (Not-for-Resale)]]></ns1:OpportunityType> </ns1:MarketingProgram><ns0:CompetitorParty>j<ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Adtran]]></ns1:Name></ns0:CompetitorParty><ns0:WorkforceReference><ns0:UserID><![CDATA[asaric]]></ns0:UserID></ns0:WorkforceReference><ns0:PullForwardDateTime>1973-05-29</ns0:PullForwardDateTime></ns0:OpportunityDetail></ns0:Opportunity>';       
            String accountXML ='<AccountList><Account><Type>Host</Type><Id>00130000003sEdSAAU</Id><HQSiteID__c>true</HQSiteID__c><AddressLine1__c>VIA TIBURTINA 605</AddressLine1__c><AddressLine2__c>null</AddressLine2__c><CSCID__c>863780</CSCID__c><CSCSiteID__c>9120461</CSCSiteID__c><City__c>ROMA</City__c><Country__c>ITALY</Country__c><Name>SOFTWAY SRL</Name><State__c>RM</State__c><TOKENID__c>null</TOKENID__c><ZipPostalCode__c>00159</ZipPostalCode__c><PGTMV_FLAG>N</PGTMV_FLAG><Partner_ID__c>90819720</Partner_ID__c><Partner360_Flag__c>Y</Partner360_Flag__c><Type>Host</Type></Account><Account><Type>Agent</Type><Id>0018000000Nt66GAAR</Id><HQSiteID__c>false</HQSiteID__c><AddressLine1__c>13595 Dulles Technology Drive</AddressLine1__c><AddressLine2__c>null</AddressLine2__c><CSCID__c>138998</CSCID__c><CSCSiteID__c>36148714</CSCSiteID__c><City__c>Herndon</City__c><Country__c>UNITED STATES</Country__c><Name>ePlus Technology inc</Name><State__c>VA</State__c><TOKENID__c>null</TOKENID__c><ZipPostalCode__c>20171</ZipPostalCode__c><Partner_ID__c>9999</Partner_ID__c><PGTMV_FLAG>N</PGTMV_FLAG><Partner360_Flag__c>N</Partner360_Flag__c><Type>Agent</Type></Account></AccountList>'; 
            //List<String> fieldList = new List<String>{}
            Map<String, Schema.SObjectField> fieldMap = new Map<String, Schema.SObjectField>();
            List<String> fieldList = new List<String>();
            fieldList.add('Account_Group__c');
            String fieldNames = 'Additional_Information__c,Additional_Service_Information__c,Address_Line_1__c,Address_Line_2__c,Adv_Services_AS__c,AIP_Deviation__c,Amount,Architecture__c,ARR_000s_Product__c,ARR_000s_Service__c,ATR_000s_Product__c,ATR_000s_Service__c,Attrition_Reason__c,Audience__c,Automate_Movement_to_Stage_3__c,Auto_Loaded_Opportunity__c,Best_Practice__c,Big_Bet__c,Booked_Oppty_Count__c,Budget_Approved__c,Business_Entity__c,Business_Issues_Compelling_Events__c,Buying_Program__c,Campaign_Description__c,CBN_Status__c,CCW_BOM_Integrated_Date__c,CCW_BOM_Integrated_Quote_Id__c,CCW_BOM_Integrated_Quote_Status__c,CCW_Calculated_Recurring_Offer__c,CCW_Recurring_Offer_Value_000__c,Cisco_Architecture_Solution__c,Cisco_Capital_Financing__c,Cisco_Impact_Comment__c,Cisco_Owner__c,Cisco_Product_of_Choice__c,Cisco_Resource_Management__c,Cisco_Technical_Solution__c,City__c,CloseDate,Closed_Oppty_Count__c,Close_Probability__c,Cloud_Deal__c,Cloud_Demand_Model__c,Cloud_Demand_Offer__c,Cloud_Demand_Partner_Service_OfferLookup__c,Cloud_Demand_Partner_Service_Offer__c,Cloud_Demand_Partner__c,Cloud_Demand_Projected_Value_000_s__c,Cloud_Demand_Proxy__c,Cloud_Demand_Term_Months__c,Cloud_Demand_Units__c,Cloud_Number_of_Units__c,Compelling_Event__c,Competitive_Details__c,Competitors__c,Competitor_Fit__c,Competitor_Tech_Fit__c,ConnectionReceivedId,ConnectionSentId,Contractual_Pricing_Letter_Opportunity__c,Contract_Number__c,Country__c,CreatedById,CreatedDate,Created_by_Me__c,Created_By_PSS__c,Created_Via_Salesforce1__c,CRP_Flag__c';
            CSOpty.dealMerge(outXML,accountXML,opptyVal.DealId__c,opptyVal.id);
            test.stopTest();
        }
        static testMethod void testUpdateLead(){
            Lead testLeadId=QuoteCollabTestClassExt.testLeadId();
            Lead testLead = [Select id ,Deal_ID__c,LastName from Lead where LastName='CSOptytacTest1_B'];
            Opportunity opptyVal = [Select id ,DealID__c, Name from Opportunity where Name ='CSOptyTest' limit 1];
            test.startTest();
            Opty o = new Opty();
            o.setDealId(testLead.id);
            String outXML = '<ns0:Opportunity xmlns:ns0=\"http://www.cisco.com/cixs2.0/oagis\"><ns0:OpportunityHeader><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID></ns1:ID></ns1:DocumentID><ns0:Discount><ns0:Name>Multiple</ns0:Name></ns0:Discount><ns1:IntendedUseOfOpportunity xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Stadium Vision]]></ns1:IntendedUseOfOpportunity><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-11Aug08-01]]></ns1:Note><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-10JAN09-cm8x]]></ns1:Name><ns1:TotalAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">45.0</ns1:TotalAmount><ns1:BudgetedAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">12.0</ns1:BudgetedAmount><ns0:SalesPosition><![CDATA[UK CENTRAL GOVT kamalpat]]></ns0:SalesPosition><ns0:NonStandardTermsCode>None</ns0:NonStandardTermsCode><ns0:NetPriceIndicator>true</ns0:NetPriceIndicator><ns0:Deal><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID>2976889</ns1:ID></ns1:DocumentID><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Test Deal for CAM conversion]]></ns1:Note><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Y</ns1:Code><ns1:EffectiveDateTime>2008-09-01</ns1:EffectiveDateTime></ns1:Status><ns0:DeskStatus><ns1:Code xmlns:ns1=\"http://www.openapplications.org/oagis/9\">Active</ns1:Code></ns0:DeskStatus><ns0:ExpiryDateTime>2008-10-10</ns0:ExpiryDateTime><ns0:ApprovalRoute>5</ns0:ApprovalRoute></ns0:Deal><ns1:CurrencyCode xmlns:ns1=\"http://www.openapplications.org/oagis/9\">USD</ns1:CurrencyCode><ns0:TotalProductAmount currencyID=\"USD\">1</ns0:TotalProductAmount> <ns0:TotalServiceAmount currencyID=\"USD\">2</ns0:TotalServiceAmount> <ns0:WorkforceReference><ns0:UserID>asaric</ns0:UserID></ns0:WorkforceReference><ns0:CustomerParty><ns0:PartyId><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[0013000000GgQtE]]></ns1:ID></ns0:PartyId><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[HOUSES OF PARLIAMENT]]></ns1:Name></ns0:CustomerParty><ns0:SalesLeadReference><ns0:DocumentID><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA['+testLeadId.Id+']]></ns1:ID></ns0:DocumentID></ns0:SalesLeadReference><ns0:WhoWhenData><ns0:UpdatedBy>jchambers</ns0:UpdatedBy><ns0:UpdatedOn>2009-02-10 01:56:37</ns0:UpdatedOn></ns0:WhoWhenData><ns0:SalesLeadReference><ns0:StatusCode>Y</ns0:StatusCode></ns0:SalesLeadReference>><ns0:DocumentReference><ns0:Description>Y</ns0:Description></ns0:DocumentReference></ns0:OpportunityHeader><ns0:OpportunityDetail><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Approved</ns1:Code></ns1:Status><ns1:CompetitorParty xmlns:ns1=\"http://www.openapplications.org/oagis/9\"/><ns0:OpportunityTechnology><ns0:Technology><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Cable]]></ns1:Name></ns0:Technology><ns0:TechnologyMixPercentage>100.0</ns0:TechnologyMixPercentage></ns0:OpportunityTechnology><ns0:OpportunityService><ns0:ServiceProgram><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare</ns1:Name><ns1:ServiceLevel xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare Software</ns1:ServiceLevel><ns0:ServiceMixPercentage>100</ns0:ServiceMixPercentage></ns0:ServiceProgram></ns0:OpportunityService><ns0:ExpectedBookingDateTime>2008-08-22</ns0:ExpectedBookingDateTime><ns0:ExpectedProductBookingAmount currencyID=\"USD\">48.0</ns0:ExpectedProductBookingAmount><ns0:ExpectedServiceBookingAmount currencyID=\"USD\">0.0</ns0:ExpectedServiceBookingAmount><ns0:SalesStageCode>1 - Prospect</ns0:SalesStageCode><ns0:Forecast><ns0:Code>Not Forecastable</ns0:Code></ns0:Forecast><ns1:MarketingProgram xmlns:ns1=\"http://www.openapplications.org/oagis/9\"> <ns1:ID>31128</ns1:ID> <ns1:Description><![CDATA[PP-NFRf29874-080426]]></ns1:Description> <ns1:OfferDescription><![CDATA[NFR for Specialised and Certified Partners]]></ns1:OfferDescription> <ns1:OpportunityType><![CDATA[NFR (Not-for-Resale)]]></ns1:OpportunityType> </ns1:MarketingProgram><ns0:CompetitorParty>j<ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Adtran]]></ns1:Name></ns0:CompetitorParty><ns0:WorkforceReference><ns0:UserID><![CDATA[asaric]]></ns0:UserID></ns0:WorkforceReference><ns0:PullForwardDateTime>1973-05-29</ns0:PullForwardDateTime></ns0:OpportunityDetail></ns0:Opportunity>';   
            CSOpty.UpdateLeadData(outXML);
            CSOpty.oneTimeLeadUpdate(testLead.Id,testLead.Deal_ID__c);
            test.stopTest();
        }
        
        static testMethod void testUpsertMultiObjectLead(){
            Opportunity opptyVal = [Select id ,DealID__c, Name from Opportunity where Name ='CSOptyTest' limit 1];
            Lead testLeadId=QuoteCollabTestClassExt.testLeadId();
            Lead testLead = [Select id ,LastName from Lead where LastName='CSOptytacTest1_B'];
            Quote__c testQuote = [select Id,CreatedById,Deal_Id__c,CreatedDate,Quote_Last_Updated__c,Quote_Last_Modified_By__c,Name,DM_Quote_ID__c,Account_Name__c,Opportunity_Name__c,PartnerAcctId__c,CBN_Status__c,CCW_Deal_Status_MQ__c from Quote__c where name = 'CSOpty Quote' limit 1];
            Multi_Object_Quote__c existingCCWRecord = new Multi_Object_Quote__c(Opportunity_Name__c=opptyVal.id,Deal_ID__c= opptyVal.DealID__c);
            insert existingCCWRecord;
            List<Multi_Object_Quote__c> newQuote = new List<Multi_Object_Quote__c>();
            newQuote.add(existingCCWRecord);
            test.startTest();
            Opty o = new Opty();
            o.setQuoteID(testQuote.Id);
            o.setDealId(testQuote.Deal_ID__c);
            List<Opportunity> testOpty = new List<Opportunity>();
            testOpty.add(opptyVal);
            system.debug('testQuote'+testQuote);
            List<Quote__c> testQu  = new List<Quote__c>();
            testQu.add(testQuote);
            String outXML = '<ns0:Opportunity xmlns:ns0=\"http://www.cisco.com/cixs2.0/oagis\"><ns0:OpportunityHeader><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID></ns1:ID></ns1:DocumentID><ns0:Discount><ns0:Name>Multiple</ns0:Name></ns0:Discount><ns1:IntendedUseOfOpportunity xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Stadium Vision]]></ns1:IntendedUseOfOpportunity><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-11Aug08-01]]></ns1:Note><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-10JAN09-cm8x]]></ns1:Name><ns1:TotalAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">45.0</ns1:TotalAmount><ns1:BudgetedAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">12.0</ns1:BudgetedAmount><ns0:SalesPosition><![CDATA[UK CENTRAL GOVT kamalpat]]></ns0:SalesPosition><ns0:NonStandardTermsCode>None</ns0:NonStandardTermsCode><ns0:NetPriceIndicator>true</ns0:NetPriceIndicator><ns0:Deal><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID>2976889</ns1:ID></ns1:DocumentID><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Test Deal for CAM conversion]]></ns1:Note><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Y</ns1:Code><ns1:EffectiveDateTime>2008-09-01</ns1:EffectiveDateTime></ns1:Status><ns0:DeskStatus><ns1:Code xmlns:ns1=\"http://www.openapplications.org/oagis/9\">Active</ns1:Code></ns0:DeskStatus><ns0:ExpiryDateTime>2008-10-10</ns0:ExpiryDateTime><ns0:ApprovalRoute>5</ns0:ApprovalRoute></ns0:Deal><ns1:CurrencyCode xmlns:ns1=\"http://www.openapplications.org/oagis/9\">USD</ns1:CurrencyCode><ns0:TotalProductAmount currencyID=\"USD\">1</ns0:TotalProductAmount> <ns0:TotalServiceAmount currencyID=\"USD\">2</ns0:TotalServiceAmount> <ns0:WorkforceReference><ns0:UserID>asaric</ns0:UserID></ns0:WorkforceReference><ns0:CustomerParty><ns0:PartyId><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[0013000000GgQtE]]></ns1:ID></ns0:PartyId><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[HOUSES OF PARLIAMENT]]></ns1:Name></ns0:CustomerParty><ns0:SalesLeadReference><ns0:DocumentID><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA['+testLeadId.Id+']]></ns1:ID></ns0:DocumentID></ns0:SalesLeadReference><ns0:WhoWhenData><ns0:UpdatedBy>jchambers</ns0:UpdatedBy><ns0:UpdatedOn>2009-02-10 01:56:37</ns0:UpdatedOn></ns0:WhoWhenData><ns0:SalesLeadReference><ns0:StatusCode>Y</ns0:StatusCode></ns0:SalesLeadReference>><ns0:DocumentReference><ns0:Description>Y</ns0:Description></ns0:DocumentReference></ns0:OpportunityHeader><ns0:OpportunityDetail><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Approved</ns1:Code></ns1:Status><ns1:CompetitorParty xmlns:ns1=\"http://www.openapplications.org/oagis/9\"/><ns0:OpportunityTechnology><ns0:Technology><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Cable]]></ns1:Name></ns0:Technology><ns0:TechnologyMixPercentage>100.0</ns0:TechnologyMixPercentage></ns0:OpportunityTechnology><ns0:OpportunityService><ns0:ServiceProgram><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare</ns1:Name><ns1:ServiceLevel xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare Software</ns1:ServiceLevel><ns0:ServiceMixPercentage>100</ns0:ServiceMixPercentage></ns0:ServiceProgram></ns0:OpportunityService><ns0:ExpectedBookingDateTime>2008-08-22</ns0:ExpectedBookingDateTime><ns0:ExpectedProductBookingAmount currencyID=\"USD\">48.0</ns0:ExpectedProductBookingAmount><ns0:ExpectedServiceBookingAmount currencyID=\"USD\">0.0</ns0:ExpectedServiceBookingAmount><ns0:SalesStageCode>1 - Prospect</ns0:SalesStageCode><ns0:Forecast><ns0:Code>Not Forecastable</ns0:Code></ns0:Forecast><ns1:MarketingProgram xmlns:ns1=\"http://www.openapplications.org/oagis/9\"> <ns1:ID>31128</ns1:ID> <ns1:Description><![CDATA[PP-NFRf29874-080426]]></ns1:Description> <ns1:OfferDescription><![CDATA[NFR for Specialised and Certified Partners]]></ns1:OfferDescription> <ns1:OpportunityType><![CDATA[NFR (Not-for-Resale)]]></ns1:OpportunityType> </ns1:MarketingProgram><ns0:CompetitorParty>j<ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Adtran]]></ns1:Name></ns0:CompetitorParty><ns0:WorkforceReference><ns0:UserID><![CDATA[asaric]]></ns0:UserID></ns0:WorkforceReference><ns0:PullForwardDateTime>1973-05-29</ns0:PullForwardDateTime></ns0:OpportunityDetail></ns0:Opportunity>';   
            CSOpty.upsertMultiObjectQuote(outXML,testLead.id,'Lead');
            CSOpty.deleteQuote(testQuote.Deal_ID__c,'1001');
            test.stopTest();
        }
        static testMethod void testUpsertMultiObjectPartner(){
            Lead testLeadId=QuoteCollabTestClassExt.testLeadId();
            Id partnerAccountId = GenericStaticTestData.gettestChannelAccountRecord1().Id;
            Assigned_Partner__c testTp = new Assigned_partner__c(Name='Test Target Prospect Record',TARGET_ARCHITECTURE__C='Any/All Technologies',TARGET_DESCRIPTION__C='Test Target Prospect Record',Assigned_Partner__c = partnerAccountId, Partner_Status__c = 'Partner Assigned', Partner_Assigned_Date__c = DateTime.now(), PSR_Assigned_Date_Time__c = DateTime.now(),ownerid = userinfo.getUserId());
            insert testTp;
            List<Assigned_Partner__c> testAss = new List<Assigned_Partner__c>();
            testAss.add(testTp);
            test.startTest();
            String outXML = '<ns0:Opportunity xmlns:ns0=\"http://www.cisco.com/cixs2.0/oagis\"><ns0:OpportunityHeader><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID></ns1:ID></ns1:DocumentID><ns0:Discount><ns0:Name>Multiple</ns0:Name></ns0:Discount><ns1:IntendedUseOfOpportunity xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Stadium Vision]]></ns1:IntendedUseOfOpportunity><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-11Aug08-01]]></ns1:Note><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[TCCTest_EU_sudhapdrsfdc-10JAN09-cm8x]]></ns1:Name><ns1:TotalAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">45.0</ns1:TotalAmount><ns1:BudgetedAmount xmlns:ns1=\"http://www.openapplications.org/oagis/9\" currencyID=\"USD\">12.0</ns1:BudgetedAmount><ns0:SalesPosition><![CDATA[UK CENTRAL GOVT kamalpat]]></ns0:SalesPosition><ns0:NonStandardTermsCode>None</ns0:NonStandardTermsCode><ns0:NetPriceIndicator>true</ns0:NetPriceIndicator><ns0:Deal><ns1:DocumentID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:ID>2976889</ns1:ID></ns1:DocumentID><ns1:Note xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Test Deal for CAM conversion]]></ns1:Note><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Y</ns1:Code><ns1:EffectiveDateTime>2008-09-01</ns1:EffectiveDateTime></ns1:Status><ns0:DeskStatus><ns1:Code xmlns:ns1=\"http://www.openapplications.org/oagis/9\">Active</ns1:Code></ns0:DeskStatus><ns0:ExpiryDateTime>2008-10-10</ns0:ExpiryDateTime><ns0:ApprovalRoute>5</ns0:ApprovalRoute></ns0:Deal><ns1:CurrencyCode xmlns:ns1=\"http://www.openapplications.org/oagis/9\">USD</ns1:CurrencyCode><ns0:TotalProductAmount currencyID=\"USD\">1</ns0:TotalProductAmount> <ns0:TotalServiceAmount currencyID=\"USD\">2</ns0:TotalServiceAmount> <ns0:WorkforceReference><ns0:UserID>asaric</ns0:UserID></ns0:WorkforceReference><ns0:CustomerParty><ns0:PartyId><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[0013000000GgQtE]]></ns1:ID></ns0:PartyId><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[HOUSES OF PARLIAMENT]]></ns1:Name></ns0:CustomerParty><ns0:SalesLeadReference><ns0:DocumentID><ns1:ID xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA['+testLeadId.Id+']]></ns1:ID></ns0:DocumentID></ns0:SalesLeadReference><ns0:WhoWhenData><ns0:UpdatedBy>jchambers</ns0:UpdatedBy><ns0:UpdatedOn>2009-02-10 01:56:37</ns0:UpdatedOn></ns0:WhoWhenData><ns0:SalesLeadReference><ns0:StatusCode>Y</ns0:StatusCode></ns0:SalesLeadReference>><ns0:DocumentReference><ns0:Description>Y</ns0:Description></ns0:DocumentReference></ns0:OpportunityHeader><ns0:OpportunityDetail><ns1:Status xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><ns1:Code>Approved</ns1:Code></ns1:Status><ns1:CompetitorParty xmlns:ns1=\"http://www.openapplications.org/oagis/9\"/><ns0:OpportunityTechnology><ns0:Technology><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Cable]]></ns1:Name></ns0:Technology><ns0:TechnologyMixPercentage>100.0</ns0:TechnologyMixPercentage></ns0:OpportunityTechnology><ns0:OpportunityService><ns0:ServiceProgram><ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare</ns1:Name><ns1:ServiceLevel xmlns:ns1=\"http://www.openapplications.org/oagis/9\">SciCare Software</ns1:ServiceLevel><ns0:ServiceMixPercentage>100</ns0:ServiceMixPercentage></ns0:ServiceProgram></ns0:OpportunityService><ns0:ExpectedBookingDateTime>2008-08-22</ns0:ExpectedBookingDateTime><ns0:ExpectedProductBookingAmount currencyID=\"USD\">48.0</ns0:ExpectedProductBookingAmount><ns0:ExpectedServiceBookingAmount currencyID=\"USD\">0.0</ns0:ExpectedServiceBookingAmount><ns0:SalesStageCode>1 - Prospect</ns0:SalesStageCode><ns0:Forecast><ns0:Code>Not Forecastable</ns0:Code></ns0:Forecast><ns1:MarketingProgram xmlns:ns1=\"http://www.openapplications.org/oagis/9\"> <ns1:ID>31128</ns1:ID> <ns1:Description><![CDATA[PP-NFRf29874-080426]]></ns1:Description> <ns1:OfferDescription><![CDATA[NFR for Specialised and Certified Partners]]></ns1:OfferDescription> <ns1:OpportunityType><![CDATA[NFR (Not-for-Resale)]]></ns1:OpportunityType> </ns1:MarketingProgram><ns0:CompetitorParty>j<ns1:Name xmlns:ns1=\"http://www.openapplications.org/oagis/9\"><![CDATA[Adtran]]></ns1:Name></ns0:CompetitorParty><ns0:WorkforceReference><ns0:UserID><![CDATA[asaric]]></ns0:UserID></ns0:WorkforceReference><ns0:PullForwardDateTime>1973-05-29</ns0:PullForwardDateTime></ns0:OpportunityDetail></ns0:Opportunity>';   
            CSOpty.upsertMultiObjectQuote(outXML,testTp.id,'Assigned_Partner__c');
            
            test.stopTest();
        }
         static testMethod void booleanTest(){
            test.startTest();
            
            MyParser.flsGet(Opportunity.DealID__c);
            test.stopTest();
            
         }
        
        
    }